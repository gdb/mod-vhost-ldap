#! /usr/bin/env python

"""Print the long name of an Internet domain.

This script will take an Internet address and print out where in the
world that message originated from, based on the top-level domain code
found in the address.  Addresses can be in any of the following forms:

    xx                -- just the country code or top-level domain identifier
    host.domain.xx    -- any Internet host or network name
    somebody@where.xx -- an Internet email address

Country codes are maintained by the RIPE Network Coordination Centre,
in coordination with the ISO 3166 Maintenance Agency at DIN Berlin.

    <url:ftp://info.ripe.net/iso3166-countrycodes>

The latest known change to this information was:

    Thu Feb 10 10:20:28 MET 1994

Usage: %s [-d] [-h] addr [addr ...]

    -d (--dump)  -- print mapping of all known top-level domains
    -h (--help)  -- print this help message

"""

import sys
import string
import getopt



def usage(status=0):
    print __doc__ % sys.argv[0]
    sys.exit(status)

def resolve(rawaddr):
    parts = string.splitfields(rawaddr, '.')
    if not len(parts):
	print 'No top-level domain in:', rawaddr
	return
    addr = parts[-1]
    if nameorg.has_key(addr):
	print addr, 'is from a USA', nameorg[addr], 'organization'
    elif country.has_key(addr):
	print addr, 'originated from', country[addr]
    else:
	print 'Where in the world is %s?' % addr



def main():
    help = 0
    status = 0
    dump = 0

    opts, args = getopt.getopt(sys.argv[1:], 'hd', ['help', 'dump'])
    for arg, val in opts:
	if arg in ('-h', '--help'):
	    help = 1
	elif arg in ('-d', '--dump'):
	    dump = 1

    if help:
	usage(status)

    if dump:
	print 'USA-centric domains:'
	codes = nameorg.keys()
	codes.sort()
	for code in codes:
	    print '    %4s:' % code, nameorg[code]

	print '\nCountry coded domains:'
	codes = country.keys()
	codes.sort()
	for code in codes:
	    print '    %2s:' % code, country[code]
    else:
	map(resolve, args)


# The mappings
nameorg = {
    "arpa": "Arpanet",
    "com": "commercial",
    "edu": "educational",
    "gov": "government",
    "mil": "military",
    "net": "networking",
    "org": "non-commercial",
    "int": "international",
    }



country = {
    "ag": "Antigua and Barbuda",
    "al": "Albania",
    "aq": "Antarctica",
    "ar": "Argentina",
    "at": "Austria",
    "au": "Australia",
    "bb": "Barbados",
    "be": "Belgium",
    "bg": "Bulgaria",
    "bo": "Bolivia",
    "br": "Brazil",
    "bs": "Bahamas",
    "bz": "Belize",
    "ca": "Canada",
    "ch": "Switzerland",
    "cl": "Chile",
    "cm": "Cameroon",
    "cn": "China",
    "co": "Colombia",
    "cr": "Costa Rica",
    "cy": "Cyprus",
    "cz": "Czech Republic",
    "de": "Germany",
    "dk": "Denmark",
    "dm": "Dominica",
    "do": "Dominican Republic",
    "ec": "Ecuador",
    "ee": "Estonia",
    "eg": "Egypt",
    "es": "Spain",
    "fi": "Finland",
    "fj": "Fiji",
    "fr": "France",
    "gb": "Great Britain",
    "gh": "Ghana",
    "gr": "Greece",
    "hk": "Hong Kong",
    "hr": "Croatia",
    "hu": "Hungary",
    "id": "Indonesia",
    "ie": "Ireland",
    "il": "Israel",
    "in": "India",
    "is": "Iceland",
    "it": "Italy",
    "jm": "Jamaica",
    "jp": "Japan",
    "km": "Comoros",
    "kn": "Saint Kitts and Nevis",
    "kr": "Republic of Korea",
    "kw": "Kuwait",
    "lc": "Saint Lucia",
    "li": "Liechtenstein",
    "lk": "Sri Lanka",
    "lu": "Luxembourg",
    "lv": "Latvia",
    "my": "Malaysia",
    "mx": "Mexico",
    "na": "Namibia",
    "ni": "Nicaragua",
    "nl": "Netherlands",
    "no": "Norway",
    "nz": "New Zealand",
    "pe": "Peru",
    "pg": "Papua New Guinea",
    "ph": "Philippines",
    "pl": "Poland",
    "pr": "Puerto Rico",
    "pt": "Portugal",
    "py": "Paraguay",
    "ro": "Romania",
    "ru": "Russia",
    "se": "Sweden",
    "sg": "Singapore",
    "si": "Slovenia",
    "sk": "Slovakia",
    "sr": "Suriname",
    "su": "USSR",
    "tw": "Taiwan",
    "th": "Thailand",
    "tn": "Tunisia",
    "tr": "Turkey",
    "tt": "Trinidad and Tobago",
    "uk": "United Kingdom",
    "us": "United States",
    "uy": "Uruguay",
    "vc": "Saint Vincent and the Grenadines",
    "ve": "Venezuela",
    "vi": "Virgin Islands",
    "yu": "Yugoslavia",
    "za": "South Africa",
    "zw": "Zimbabwe",
    }



if __name__ == '__main__':
    main()
